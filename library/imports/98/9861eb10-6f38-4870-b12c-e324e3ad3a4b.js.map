{"version":3,"sources":["../../../../../../assets/myScripts/platform/IAP/assets/myScripts/platform/IAP/iap.js"],"names":["window","mylog","console","log","iap_mob","callback","str","init","cc","sys","isMobile","sdkbox","IAP","refreshIAP","setCallback","self","setListener","onProductRequestSuccess","products","onProductRequestFailure","msg","onSuccess","p","onFailure","onCanceled","onRestored","key","id","ID_COLLECTION","REMOVEAD","onRestoreComplete","ok","onShouldAddStorePayment","productName","onFetchStorePromotionOrder","productNames","error","onFetchStorePromotionVisibility","visibility","onUpdateStorePromotionOrder","onUpdateStorePromotionVisibility","refresh","remove_ads","purchase","remove_ads2","hint","unlock","restore","module","exports"],"mappings":"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","file":"iap.js","sourceRoot":"../../../../../../assets/myScripts/platform/IAP","sourcesContent":["window.mylog = console.log\nlet iap_mob = {\n    callback: function (str) {\n        mylog('iap call back not implement')\n    },\n    init: function() {\n        if (!cc.sys.isMobile)\n            return false\n        mylog('iap init')\n        sdkbox.IAP.init();\n        this.refreshIAP()\n    },\n    setCallback: function(callback) {\n        if (!cc.sys.isMobile)\n            return false\n            let self = this\n            sdkbox.IAP.setListener({\n            //检索成功\n            onProductRequestSuccess: function(products) {\n                mylog('iap  refresh  Success 检索成功');\n                self.callback('onProductRequestSuccess',products)\n            },\n            //检索失败\n            onProductRequestFailure: function(msg) {\n                mylog('iap refresh fail 检索失败');\n                self.callback('onProductRequestFailure', msg)\n            },\n            //购买成功\n            onSuccess: function(p) {\n                mylog('iap  bug onsuccess name= 购买成功');\n                mylog(\"购买成功 返回对象\" + p)\n                self.callback('onBuy',p)\n            },\n            //购买失败\n            onFailure: function(p,msg) {\n                mylog('iap 购买失败');\n                //this.cacheADByName(name)\n                self.callback('onFailure',p,msg)\n            },\n            //如果用户取消则触发\n            onCanceled: function(p) {\n                mylog('iap onCanceled 如果用户取消则触发' );\n                self.callback('onCanceled',p)\n            },\n            //恢复购买成功则触发  可以多次触发\n            onRestored: function(p) {\n                mylog('iap onRestored 恢复购买成功则触发  可以多次触发' );\n\t\tconsole.log(p)\n\t\tfor (let key in p )\n\t\t{\n\t\t\tconsole.log(key, p[key])\n\t\t}\n                self.callback('onRestored', p.id == ID_COLLECTION.REMOVEAD)\n            },\n            //恢复购买回调\n            onRestoreComplete:function(ok , msg ){\n                mylog('iap onRestored 恢复购买回调' );\n                self.callback('onRestoreComplete',ok,msg)\n            },\n\n            onShouldAddStorePayment:function(productName ){\n                mylog('' );\n                self.callback('onShouldAddStorePayment',productName)\n            },\n\n            onFetchStorePromotionOrder(productNames , error ) {\n                self.callback('onFetchStorePromotionOrder',productNames,error)\n            },\n\n            onFetchStorePromotionVisibility(productName  , visibility  , error) {\n                self.callback('onFetchStorePromotionVisibility',productName,visibility,error)\n            },\n\n            onUpdateStorePromotionOrder(error) {\n                self.callback('onUpdateStorePromotionOrder',error)\n            },\n\n            onUpdateStorePromotionVisibility(error ) {\n                self.callback('onUpdateStorePromotionVisibility',error)\n            },\n        });\n        this.callback = callback\n    },\n\n    //检索当前iap\n    refreshIAP: function() {\n        if (!cc.sys.isMobile)\n            return false\n        sdkbox.IAP.refresh();\n    },\n\n    //进行购买\n    remove_ads: function() {\n        if (!cc.sys.isMobile)\n            return false\n        sdkbox.IAP.purchase(\"remove_ads\") //去广告\n    },\n\n    remove_ads2: function() {\n        if (!cc.sys.isMobile)\n            return false\n        sdkbox.IAP.purchase(\"remove_ads2\") //去广告\n    },\n\n    hint: function() {\n        if (!cc.sys.isMobile)\n            return false\n        sdkbox.IAP.purchase(\"hint\")\n    },\n\n    unlock: function() {\n        if (!cc.sys.isMobile)\n            return false\n        sdkbox.IAP.purchase(\"unlock\")\n    },\n\n    //恢复购买\n    restore: function() {\n        if (!cc.sys.isMobile)\n            return false\n        mylog('iap restore')\n        sdkbox.IAP.restore();\n    },\n}\nmodule.exports = iap_mob"]}